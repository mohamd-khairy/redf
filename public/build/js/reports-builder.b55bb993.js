(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["reports-builder"],{8905:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex-grow-1"},[s("v-card",{attrs:{loading:e.loading}},[s("v-card-text",{staticClass:"p-3 roles"},[s("v-form",[s("div",{staticClass:"title mb-2"},[e._v(" "+e._s(e.$t("reports.showReport"))+" ")]),s("v-row",[s("v-col",{attrs:{cols:"12",md:"6"}},[s("v-select",{attrs:{items:e.models,rules:[e.rules.required],variant:"underlined",label:e.$t("reports.model"),"item-text":"value","item-value":"key",outlined:"","hide-details":"",dense:""},model:{value:e.selectedModel,callback:function(t){e.selectedModel=t},expression:"selectedModel"}})],1),s("v-col",{attrs:{cols:"12",md:"6"}},[s("v-select",{attrs:{items:e.report_types,variant:"underlined",label:e.$t("reports.reportType"),"item-text":"value","item-value":"key","hide-details":"",outlined:"",dense:""},model:{value:e.selectedReport,callback:function(t){e.selectedReport=t},expression:"selectedReport"}})],1),s("v-col",{attrs:{cols:"12"}},[s("v-select",{attrs:{items:e.show_types,variant:"underlined",label:e.$t("reports.showType"),"item-text":"value","item-value":"key","hide-details":"",outlined:"",dense:""},model:{value:e.selectedShow,callback:function(t){e.selectedShow=t},expression:"selectedShow"}})],1),"specific"===e.selectedShow?s("v-col",{attrs:{cols:"12",md:"6"}},[s("v-select",{attrs:{items:e.locations,rules:[e.rules.required],variant:"underlined",label:e.$t("reports.specificLocation"),"item-text":"name","item-value":"id",dense:"",outlined:"","hide-details":""},model:{value:e.selectedSpecificLocation,callback:function(t){e.selectedSpecificLocation=t},expression:"selectedSpecificLocation"}})],1):e._e(),"types"===e.selectedReport&&"comparison"===e.selectedShow?s("v-col",{attrs:{cols:"12"}},[s("v-select",{attrs:{items:e.eventTypes,variant:"underlined",label:e.$t("reports.typeComparisons"),"item-text":"key","item-value":"value","hide-details":"","return-object":"",multiple:"",outlined:"",dense:""},model:{value:e.selectedComparisonTypes,callback:function(t){e.selectedComparisonTypes=t},expression:"selectedComparisonTypes"}})],1):e._e(),"comparison"===e.selectedShow?s("v-col",{attrs:{cols:"12",md:"6"}},[s("v-select",{attrs:{items:e.locations,rules:[e.rules.required],variant:"underlined",label:e.$t("reports.locationComparisons"),"item-text":"name","item-value":"id","return-object":"",multiple:"",outlined:"","hide-details":"",dense:""},model:{value:e.selectedComparisonLocation,callback:function(t){e.selectedComparisonLocation=t},expression:"selectedComparisonLocation"}})],1):e._e(),"types"===e.selectedReport&&"specific"===e.selectedShow?s("v-col",{attrs:{cols:"12",md:"6"}},[s("v-select",{attrs:{items:e.eventTypes,variant:"underlined",label:e.$t("reports.specificType"),"item-text":"key","item-value":"value","hide-details":"","return-object":"",outlined:"",dense:""},model:{value:e.selectedSpecificType,callback:function(t){e.selectedSpecificType=t},expression:"selectedSpecificType"}})],1):e._e(),s("v-col",{attrs:{cols:"12",md:"6"}},[s("v-select",{attrs:{items:e.time_types,variant:"underlined",label:e.$t("reports.timeType"),"item-text":"value","item-value":"key","hide-details":"","return-object":"",outlined:"",dense:""},on:{change:e.selectTimeType},model:{value:e.selectedTime,callback:function(t){e.selectedTime=t},expression:"selectedTime"}})],1),"dynamic"===e.selectedTime.key?s("v-col",{attrs:{cols:"12",md:"6"}},[s("v-select",{attrs:{items:e.dates,label:e.$t("reports.date"),"item-text":"value","item-value":"key","hide-details":"",outlined:"",dense:""},model:{value:e.selectedDate,callback:function(t){e.selectedDate=t},expression:"selectedDate"}})],1):e._e(),"specific"===e.selectedTime.key?s("v-col",{attrs:{cols:"12",md:"6"}},[s("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","min-width":"290px"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[s("v-text-field",e._g({attrs:{label:e.$t("reports.selectFromDate"),"prepend-icon":"mdi mdi-calendar",readonly:"",outlined:"",dense:""},model:{value:e.fromDate,callback:function(t){e.fromDate=t},expression:"fromDate"}},i))]}}],null,!1,4145479561),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[s("v-date-picker",{on:{input:function(t){e.menu=!1}},model:{value:e.fromDate,callback:function(t){e.fromDate=t},expression:"fromDate"}})],1)],1):e._e(),"specific"===e.selectedTime.key?s("v-col",{attrs:{cols:"12",md:"6"}},[s("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","min-width":"290px"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[s("v-text-field",e._g({attrs:{label:e.$t("reports.selectToDate"),"prepend-icon":"mdi mdi-calendar",readonly:"",outlined:"",dense:""},model:{value:e.toDate,callback:function(t){e.toDate=t},expression:"toDate"}},i))]}}],null,!1,146641961),model:{value:e.menu2,callback:function(t){e.menu2=t},expression:"menu2"}},[s("v-date-picker",{on:{input:function(t){e.menu2=!1}},model:{value:e.toDate,callback:function(t){e.toDate=t},expression:"toDate"}})],1)],1):e._e()],1),s("div",{staticClass:"d-flex mt-10"},[s("v-btn",{attrs:{loading:e.loading,disabled:e.loading,color:"primary"},on:{click:function(t){return e.showReport()}}},[e._v(" "+e._s(e.$t("reports.show"))+" ")])],1)],1)],1)],1)],1)},o=[],a=(s("4de4"),s("4160"),s("159b"),s("5530")),l=s("2f62"),c={name:"Builder",data:function(){return{errors:{},errorMessages:"",loading:!1,menu:!1,menu2:!1,selectedModel:"",selectedReport:"",selectedShow:"",selectedTime:{},selectedSpecificLocation:"",selectedComparisonLocation:[],selectedSpecificType:{},selectedComparisonTypes:[],selectedDate:"",fromDate:"",toDate:"",dates:[],breadcrumbs:[{text:this.$t("reports.reports"),disabled:!0},{text:this.$t("reports.buildReport")}],rules:{required:function(e){return e&&Boolean(e)||"Required"}}}},watch:{},computed:Object(a["a"])(Object(a["a"])(Object(a["a"])({},Object(l["e"])("reports",["models","report_types","show_types","time_types","chartData","chartFilter"])),Object(l["e"])("locations",["locations"])),Object(l["e"])("events",["eventTypes"])),created:function(){this.setBreadCrumb({breadcrumbs:this.breadcrumbs,pageTitle:this.$t("reports.buildReport")})},mounted:function(){this.open(),this.fetchLocations(),this.fetchTypes()},methods:Object(a["a"])(Object(a["a"])(Object(a["a"])(Object(a["a"])(Object(a["a"])({},Object(l["b"])("reports",["getBuilderOptions","buildReport"])),Object(l["b"])("app",["setBreadCrumb"])),Object(l["b"])("locations",["getLocations"])),Object(l["b"])("events",["getTypes"])),{},{open:function(){var e=this;this.isLoading=!0,this.getBuilderOptions().then((function(){e.isLoading=!1})).catch((function(){e.isLoading=!1}))},fetchLocations:function(){var e=this;this.isLoading=!0,this.getLocations().then((function(){e.isLoading=!1})).catch((function(){e.isLoading=!1}))},fetchTypes:function(){var e=this;this.isLoading=!0,this.getTypes().then((function(){e.isLoading=!1})).catch((function(){e.isLoading=!1}))},selectTimeType:function(){"dynamic"===this.selectedTime.key&&(this.dates=this.selectedTime.dates)},showReport:function(){var e=this;this.isLoading=!0;var t={},s=[],i=[];this.selectedComparisonLocation&&this.selectedComparisonLocation.forEach((function(e){s.push(e.id)})),this.selectedSpecificLocation&&s.push(this.selectedSpecificLocation),this.selectedComparisonTypes&&this.selectedComparisonTypes.forEach((function(e){i.push(e.key)})),"{}"!=JSON.stringify(this.selectedSpecificType)&&i.push(this.selectedSpecificType.key),t={report_list:this.selectedReport,model_type:this.selectedModel,time_type:this.selectedTime.key,site_ids:s,type:this.selectedShow,types:i,time_range:this.selectedDate,start:this.fromDate,end:this.toDate},this.buildReport(t).then((function(t){e.isLoading=!1,e.$router.push({name:"reports-show-builder",params:{data:t.data.data,filter:t.data.filter}})})).catch((function(t){var s;if(e.isLoading=!1,422==(null===t||void 0===t||null===(s=t.response)||void 0===s?void 0:s.status)){var i,o=null===t||void 0===t||null===(i=t.response)||void 0===i?void 0:i.data,a=o.message;e.errorMessages=a}}))}})},n=c,r=s("2877"),d=s("6544"),u=s.n(d),p=s("8336"),m=s("b0afa"),v=s("99d9"),f=s("62ad"),h=s("2e4b"),b=s("4bd4"),y=s("e449"),T=s("0fd9"),k=s("b974"),g=s("8654"),x=Object(r["a"])(n,i,o,!1,null,"6bcce674",null);t["default"]=x.exports;u()(x,{VBtn:p["a"],VCard:m["a"],VCardText:v["d"],VCol:f["a"],VDatePicker:h["a"],VForm:b["a"],VMenu:y["a"],VRow:T["a"],VSelect:k["a"],VTextField:g["a"]})},afdd:function(e,t,s){"use strict";var i=s("8336");s.d(t,"a",(function(){return i["a"]})),t["b"]=i["a"]}}]);